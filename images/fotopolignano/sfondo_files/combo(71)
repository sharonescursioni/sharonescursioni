YUI.add("search-orientation-picker-view",(function(e){var t=[{intlKey:"search.LANDSCAPE",value:"landscape",cssClass:"landscape",selected:!0},{intlKey:"search.PORTRAIT",value:"portrait",cssClass:"portrait",selected:!0},{intlKey:"search.SQUARE",value:"square",cssClass:"square",selected:!0},{intlKey:"search.PANORAMA",value:"panorama",cssClass:"panorama",selected:!0}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){var a,s,n=this;return this.searchUrl=i.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),a=this.searchUrl.getAPIParam(e.SearchHelper.API.orientation),this.selectedOrientations=[],this.orientations=[],t.forEach((function(t){s=e.merge(t),a&&(s.selected=-1!==a.indexOf(t.value)),s.selected&&n.selectedOrientations.push(s.value),n.orientations.push(s)})),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-orientation-picker",{orientations:this.orientations}),this.updateContainerDisabledState(),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleOrientationClick.bind(this),".orientation-button")),this.registerEventHandler(this.get("container").delegate("key",this.handleOrientationClick.bind(this),"down:13",".orientation-button")),this},handleOrientationClick:function(t){var i=t.target.getData("orientation-value"),a=this.selectedOrientations.indexOf(i);if(t.halt(),-1===a)this.selectedOrientations.push(i),t.target.addClass("checked"),this.updateContainerDisabledState();else{if(this.isContainerDisabled())return;this.selectedOrientations.splice(a,1),t.target.removeClass("checked"),this.updateContainerDisabledState()}this.isDefaultValue()?this.searchUrl.removeAPIParam(e.SearchHelper.API.orientation):this.searchUrl.setAPIParam(e.SearchHelper.API.orientation,this.selectedOrientations.join(",")),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},updateContainerDisabledState:function(){this.selectedOrientations.length<=1?this.get("container").addClass("disabled"):this.get("container").removeClass("disabled")},isContainerDisabled:function(){return!!this.get("container").hasClass("disabled")},isDefaultValue:function(){return this.selectedOrientations&&this.selectedOrientations.length===t.length}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-orientation-picker","search-helper","search-url"],langBundles:["search"]});YUI.add("hermes-template-search-min-size-picker",(function(e,l){var n=e.Template.Handlebars.revive({1:function(e,l,n,a,t){var i,o=null!=l?l:e.nullContext||{},s=e.hooks.helperMissing,r=e.escapeExpression,u=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'\t\t<li class="size-button'+(null!=(i=u(n,"if").call(o,null!=l?u(l,"isFirst"):l,{name:"if",hash:{},fn:e.program(2,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:24},end:{line:4,column:52}}}))?i:"")+(null!=(i=u(n,"if").call(o,null!=l?u(l,"isLast"):l,{name:"if",hash:{},fn:e.program(4,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:52},end:{line:4,column:78}}}))?i:"")+(null!=(i=u(n,"if").call(o,null!=l?u(l,"selected"):l,{name:"if",hash:{},fn:e.program(6,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:78},end:{line:4,column:110}}}))?i:"")+' tabbable"'+(null!=(i=u(n,"if").call(o,null!=l?u(l,"value"):l,{name:"if",hash:{},fn:e.program(8,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:120},end:{line:4,column:168}}}))?i:"")+' data-tooltip-title="'+r((u(n,"intlMessage")||l&&u(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:null!=l?u(l,"titleIntlKey"):l},data:t,loc:{start:{line:4,column:189},end:{line:4,column:226}}}))+(null!=(i=u(n,"if").call(o,null!=l?u(l,"value"):l,{name:"if",hash:{},fn:e.program(10,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:226},end:{line:4,column:258}}}))?i:"")+'" data-tooltip-prefer-bottom="true" tabindex="0" aria-label="'+r((u(n,"intlMessage")||l&&u(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:null!=l?u(l,"titleIntlKey"):l},data:t,loc:{start:{line:4,column:319},end:{line:4,column:356}}}))+(null!=(i=u(n,"if").call(o,null!=l?u(l,"value"):l,{name:"if",hash:{},fn:e.program(10,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:356},end:{line:4,column:388}}}))?i:"")+'"><span aria-hidden="true">'+r((u(n,"intlMessage")||l&&u(l,"intlMessage")||s).call(o,{name:"intlMessage",hash:{intlName:null!=l?u(l,"intlKey"):l},data:t,loc:{start:{line:4,column:415},end:{line:4,column:447}}}))+"<span></li>\n"},2:function(e,l,n,a,t){return" first"},4:function(e,l,n,a,t){return" last"},6:function(e,l,n,a,t){return" selected"},8:function(e,l,n,a,t){var i,o=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return' data-size-value="'+e.escapeExpression("function"==typeof(i=null!=(i=o(n,"value")||(null!=l?o(l,"value"):l))?i:e.hooks.helperMissing)?i.call(null!=l?l:e.nullContext||{},{name:"value",hash:{},data:t,loc:{start:{line:4,column:151},end:{line:4,column:160}}}):i)+'"'},10:function(e,l,n,a,t){var i,o=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return" ("+e.escapeExpression("function"==typeof(i=null!=(i=o(n,"value")||(null!=l?o(l,"value"):l))?i:e.hooks.helperMissing)?i.call(null!=l?l:e.nullContext||{},{name:"value",hash:{},data:t,loc:{start:{line:4,column:241},end:{line:4,column:250}}}):i)+")"},compiler:[8,">= 4.3.0"],main:function(e,l,n,a,t){var i,o=null!=l?l:e.nullContext||{},s=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<p class="option-header tabbable" tabindex="0">'+e.escapeExpression((s(n,"intlMessage")||l&&s(l,"intlMessage")||e.hooks.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"search.MINIMUM_SIZE"},data:t,loc:{start:{line:1,column:47},end:{line:1,column:93}}}))+'</p>\n<ul class="size-list">\n'+(null!=(i=s(n,"each").call(o,null!=l?s(l,"sizes"):l,{name:"each",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t,loc:{start:{line:3,column:1},end:{line:5,column:10}}}))?i:"")+"</ul>\n"},useData:!0}),a={};e.Array.each([],(function(l){var n=e.Template.get("hermes/"+l);n&&(a[l]=n)})),e.Template.register("hermes/search-min-size-picker",(function(l,t){return(t=t||{}).partials=t.partials?e.merge(a,t.partials):a,n(l,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-min-size-picker-view",(function(e){var t=[{intlKey:"search.SMALL_SHORT",titleIntlKey:"search.SMALL_SHOW_ALL_SIZES",selected:!0},{intlKey:"search.MEDIUM_SHORT",titleIntlKey:"search.MEDIUM",value:"640"},{intlKey:"search.LARGE_SHORT",titleIntlKey:"search.LARGE",value:"1024"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){var s,r,a,h,l=this;return this.searchUrl=i.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),s=this.searchUrl.getAPIParam(e.SearchHelper.API.dimensionSearchMode),r=this.searchUrl.getAPIParam(e.SearchHelper.API.height),a=this.searchUrl.getAPIParam(e.SearchHelper.API.width),this.sizes=[],t.forEach((function(t){h=e.merge(t),s&&r&&a&&(h.selected=t.value&&r===t.value&&a===t.value&&"min"===s),h.selected&&l.set("selectedSize",h.value),l.sizes.push(h)})),this.sizes[0].isFirst=!0,this.sizes[this.sizes.length-1].isLast=!0,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-min-size-picker",{sizes:this.sizes}),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleSizeClick.bind(this),".size-button")),this.registerEventHandler(this.get("container").delegate("key",this.handleSizeClick.bind(this),"down:13",".size-button")),this},handleSizeClick:function(t){var i=t.currentTarget.getData("size-value");t.halt(),this.get("selectedSize")!==i&&(this.set("selectedSize",i),this.get("container").one(".size-button.selected").removeClass("selected"),t.currentTarget.addClass("selected"),!this.get("selectedSize")||this.isDefaultValue()?(this.searchUrl.removeAPIParam(e.SearchHelper.API.dimensionSearchMode),this.searchUrl.removeAPIParam(e.SearchHelper.API.height),this.searchUrl.removeAPIParam(e.SearchHelper.API.width)):(this.searchUrl.setAPIParam(e.SearchHelper.API.dimensionSearchMode,"min"),this.searchUrl.setAPIParam(e.SearchHelper.API.height,this.get("selectedSize")),this.searchUrl.setAPIParam(e.SearchHelper.API.width,this.get("selectedSize"))),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl))},isDefaultValue:function(){return!this.get("selectedSize")}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-min-size-picker","search-helper","search-url"],langBundles:["search"]});YUI.add("hermes-template-search-search-in-picker",(function(e,n){var l=e.Template.Handlebars.revive({1:function(e,n,l,a,t){var r,s=null!=n?n:e.nullContext||{},i=e.hooks.helperMissing,o=e.escapeExpression,c=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t\t<li class="search-in-button'+(null!=(r=c(l,"if").call(s,null!=n?c(n,"isFirst"):n,{name:"if",hash:{},fn:e.program(2,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:29},end:{line:4,column:57}}}))?r:"")+(null!=(r=c(l,"if").call(s,null!=n?c(n,"isLast"):n,{name:"if",hash:{},fn:e.program(4,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:57},end:{line:4,column:83}}}))?r:"")+(null!=(r=c(l,"if").call(s,null!=n?c(n,"selected"):n,{name:"if",hash:{},fn:e.program(6,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:83},end:{line:4,column:115}}}))?r:"")+' tabbable"'+(null!=(r=c(l,"if").call(s,null!=n?c(n,"value"):n,{name:"if",hash:{},fn:e.program(8,t,0),inverse:e.noop,data:t,loc:{start:{line:4,column:125},end:{line:4,column:178}}}))?r:"")+' data-tooltip-title="'+o((c(l,"intlMessage")||n&&c(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:null!=n?c(n,"titleIntlKey"):n},data:t,loc:{start:{line:4,column:199},end:{line:4,column:236}}}))+'" data-tooltip-prefer-bottom="true" tabindex="0">'+o((c(l,"intlMessage")||n&&c(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:null!=n?c(n,"intlKey"):n},data:t,loc:{start:{line:4,column:285},end:{line:4,column:317}}}))+"</li>\n"},2:function(e,n,l,a,t){return" first"},4:function(e,n,l,a,t){return" last"},6:function(e,n,l,a,t){return" selected"},8:function(e,n,l,a,t){var r,s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return' data-search-in-value="'+e.escapeExpression("function"==typeof(r=null!=(r=s(l,"value")||(null!=n?s(n,"value"):n))?r:e.hooks.helperMissing)?r.call(null!=n?n:e.nullContext||{},{name:"value",hash:{},data:t,loc:{start:{line:4,column:161},end:{line:4,column:170}}}):r)+'"'},compiler:[8,">= 4.3.0"],main:function(e,n,l,a,t){var r,s=null!=n?n:e.nullContext||{},i=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<p class="option-header tabbable" tabindex="0">'+e.escapeExpression((i(l,"intlMessage")||n&&i(n,"intlMessage")||e.hooks.helperMissing).call(s,{name:"intlMessage",hash:{intlName:"search.SEARCH_IN"},data:t,loc:{start:{line:1,column:47},end:{line:1,column:90}}}))+'</p>\n<ul class="search-in-list">\n'+(null!=(r=i(l,"each").call(s,null!=n?i(n,"searchIns"):n,{name:"each",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t,loc:{start:{line:3,column:1},end:{line:5,column:10}}}))?r:"")+"</ul>\n"},useData:!0}),a={};e.Array.each([],(function(n){var l=e.Template.get("hermes/"+n);l&&(a[n]=l)})),e.Template.register("hermes/search-search-in-picker",(function(n,t){return(t=t||{}).partials=t.partials?e.merge(a,t.partials):a,l(n,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-search-in-picker-view",(function(e){var t=[{intlKey:"search.ALL",titleIntlKey:"search.FULL_TEXT",value:"text",selected:!0},{intlKey:"search.TAGS",titleIntlKey:"search.TAGS_ONLY",value:"tags"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(s){var r,a,i=this;return this.searchUrl=s.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),r=this.searchUrl.getAPIParam(e.SearchHelper.API.tags),this.searchIns=[],t.forEach((function(t){a=e.merge(t),(r||""===r)&&(a.selected="tags"===a.value),a.selected&&i.set("selectedSearchIn",a.value),i.searchIns.push(a)})),this.searchIns[0].isFirst=!0,this.searchIns[this.searchIns.length-1].isLast=!0,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-search-in-picker",{searchIns:this.searchIns}),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",this.handleSearchInClick.bind(this),".search-in-button")),this.registerEventHandler(this.get("container").delegate("key",this.handleSearchInClick.bind(this),"down:13",".search-in-button")),this},handleSearchInClick:function(t){var s=t.target.getData("search-in-value"),r=this.searchUrl.getSearchTerm();t.halt(),this.get("selectedSearchIn")!==s&&(this.set("selectedSearchIn",s),this.get("container").one(".search-in-button.selected").removeClass("selected"),t.target.addClass("selected"),this.searchUrl.removeAPIParam(e.SearchHelper.API.text),this.searchUrl.removeAPIParam(e.SearchHelper.API.tags),!this.get("selectedSearchIn")||this.isDefaultValue()?this.searchUrl.setAPIParam(e.SearchHelper.API.text,r):this.searchUrl.setAPIParam(e.SearchHelper.API.tags,r),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl))},isDefaultValue:function(){return"text"===this.get("selectedSearchIn")}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-search-in-picker"],langBundles:["search"]});YUI.add("hermes-template-search-date-picker",(function(e,a){var n=e.Template.Handlebars.revive({1:function(e,a,n,l,t){return" compact"},compiler:[8,">= 4.3.0"],main:function(e,a,n,l,t){var s,i,r=null!=a?a:e.nullContext||{},o=e.hooks.helperMissing,c=e.escapeExpression,d=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="dropdown-link date-mode-menu tabbable" tabindex="-1"><p class="option-header">'+c("function"==typeof(i=null!=(i=d(n,"dateMode")||(null!=a?d(a,"dateMode"):a))?i:o)?i.call(r,{name:"dateMode",hash:{},data:t,loc:{start:{line:1,column:90},end:{line:1,column:102}}}):i)+'</p><span class="dropdown-arrow" aria-haspopup="true" aria-expanded="false"></span></div>\n<div class="date-inputs'+(null!=(s=d(n,"if").call(r,null!=a?d(a,"isCompact"):a,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t,loc:{start:{line:2,column:23},end:{line:2,column:55}}}))?s:"")+'">\n  <div class="date-input-container">\n    <label>'+c((d(n,"intlMessage")||a&&d(a,"intlMessage")||o).call(r,{name:"intlMessage",hash:{intlName:"common.FROM"},data:t,loc:{start:{line:4,column:11},end:{line:4,column:49}}}))+'</label>\n    <input type="text" id="date-from" class="date-picker tabbable" placeholder="'+c((d(n,"intlMessage")||a&&d(a,"intlMessage")||o).call(r,{name:"intlMessage",hash:{intlName:"pika-day.DATE_FORMAT"},data:t,loc:{start:{line:5,column:80},end:{line:5,column:127}}}))+'" tabindex="0" />\n  </div>\n  <div class="date-input-container">\n    <label>'+c((d(n,"intlMessage")||a&&d(a,"intlMessage")||o).call(r,{name:"intlMessage",hash:{intlName:"search.TO"},data:t,loc:{start:{line:8,column:11},end:{line:8,column:47}}}))+'</label>\n    <input type="text" id="date-to" class="date-picker tabbable" placeholder="'+c((d(n,"intlMessage")||a&&d(a,"intlMessage")||o).call(r,{name:"intlMessage",hash:{intlName:"pika-day.DATE_FORMAT"},data:t,loc:{start:{line:9,column:78},end:{line:9,column:125}}}))+'" tabindex="0" />\n  </div>\n</div>\n'},useData:!0}),l={};e.Array.each([],(function(a){var n=e.Template.get("hermes/"+a);n&&(l[a]=n)})),e.Template.register("hermes/search-date-picker",(function(a,t){return(t=t||{}).partials=t.partials?e.merge(l,t.partials):l,n(a,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-date-picker-view",(function(e){var t=[{intlKey:"search.DATE_TAKEN",value:"taken",isDefault:!0},{intlKey:"search.DATE_UPLOADED",value:"upload"}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var i,s,n,l,r,o=this;return this.searchUrl=a.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),this.isCompact=a.isCompact,i=this.searchUrl.getAPIParam(e.SearchHelper.API.minTakenDate),s=this.searchUrl.getAPIParam(e.SearchHelper.API.maxTakenDate),n=this.searchUrl.getAPIParam(e.SearchHelper.API.minUploadDate),l=this.searchUrl.getAPIParam(e.SearchHelper.API.maxUploadDate),this.closeOnScrollDistance=40,this.dateModes=[],t.forEach((function(t){r=e.merge(t,{text:o.intlMessage({intlName:t.intlKey})}),i||s?"taken"===r.value&&(o.set("selectedDateMode",r.value),o.set("selectedDateModeText",r.text)):n||l?"upload"===r.value&&(o.set("selectedDateMode",r.value),o.set("selectedDateModeText",r.text)):r.isDefault&&(o.set("selectedDateMode",r.value),o.set("selectedDateModeText",r.text)),o.dateModes.push(r)})),i||s?(this.set("selectedDateFrom",i),this.set("selectedDateTo",s)):(n||l)&&(this.set("selectedDateFrom",n),this.set("selectedDateTo",l)),this.dateIntl={previousMonth:this.intlMessage({intlName:"pika-day.PREVIOUS_MONTH"}),nextMonth:this.intlMessage({intlName:"pika-day.NEXT_MONTH"})},this.dateIntl.weekdays=[this.intlMessage({intlName:"pika-day.SUNDAY"}),this.intlMessage({intlName:"pika-day.MONDAY"}),this.intlMessage({intlName:"pika-day.TUESDAY"}),this.intlMessage({intlName:"pika-day.WEDNESDAY"}),this.intlMessage({intlName:"pika-day.THURSDAY"}),this.intlMessage({intlName:"pika-day.FRIDAY"}),this.intlMessage({intlName:"pika-day.SATURDAY"})],this.dateIntl.weekdaysShort=[this.intlMessage({intlName:"pika-day.SUNDAY_SHORT"}),this.intlMessage({intlName:"pika-day.MONDAY_SHORT"}),this.intlMessage({intlName:"pika-day.TUESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.WEDNESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.THURSDAY_SHORT"}),this.intlMessage({intlName:"pika-day.FRIDAY_SHORT"}),this.intlMessage({intlName:"pika-day.SATURDAY_SHORT"})],this.dateIntl.months=[this.intlMessage({intlName:"pika-day.JANUARY"}),this.intlMessage({intlName:"pika-day.FEBRUARY"}),this.intlMessage({intlName:"pika-day.MARCH"}),this.intlMessage({intlName:"pika-day.APRIL"}),this.intlMessage({intlName:"pika-day.MAY"}),this.intlMessage({intlName:"pika-day.JUNE"}),this.intlMessage({intlName:"pika-day.JULY"}),this.intlMessage({intlName:"pika-day.AUGUST"}),this.intlMessage({intlName:"pika-day.SEPTEMBER"}),this.intlMessage({intlName:"pika-day.OCTOBER"}),this.intlMessage({intlName:"pika-day.NOVEMBER"}),this.intlMessage({intlName:"pika-day.DECEMBER"})],this.basePikadayOptions={i18n:this.dateIntl,reposition:!0,format:this.intlMessage({intlName:"pika-day.DATE_FORMAT"}),yearRange:[1826,(new Date).getFullYear()],onSelect:this.handleDateChange.bind(this),onOpen:function(){o.observePickerPageScroll(this)},onClose:function(){o.detachPickerPageScroll(this)}},this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("search-date-picker",{dateMode:this.get("selectedDateModeText"),isCompact:this.isCompact}),this},activate:function(){this.setupDatePickers();var e=this.get("container").one(".date-mode-menu");return this.registerEventHandler(e.on("click",this.handleDateModeMenuClick.bind(this))),this.registerEventHandler(e.on("key",this.handleDateModeMenuClick.bind(this),"down:13")),this.registerEventHandler(this.get("container").delegate("change",this.handleDateInputFieldChange.bind(this),".date-picker")),this},setupDatePickers:function(){var t=this.get("selectedDateFrom"),a=this.get("selectedDateTo");this.datePickers={},this.datePickers.from=new e.Pikaday(e.merge(this.basePikadayOptions,{field:this.get("container").one("#date-from.date-picker").getDOMNode(),defaultDate:t?new Date(1e3*parseInt(t)):null,setDefaultDate:!!t,position:"bottom left"})),this.datePickers.from.el.classList.add("search-from-pikaday"),this.datePickers.to=new e.Pikaday(e.merge(this.basePikadayOptions,{field:this.get("container").one("#date-to.date-picker").getDOMNode(),defaultDate:a?new Date(1e3*parseInt(a)):null,setDefaultDate:!!a,position:"bottom right"})),this.datePickers.to.el.classList.add("search-to-pikaday")},handleDateModeMenuClick:function(t){var a=this;t.halt(),this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:this.get("container").one(".dropdown-arrow"),keyboardAnchorElement:this.get("container").one(".dropdown-link"),positionFixed:!0,closeOnScroll:!0,preferLeft:!0,menuItems:this.dateModes}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",(function(e){e&&e.menuItem&&e.menuItem.value!==a.get("selectedDateMode")&&(a.set("selectedDateMode",e.menuItem.value),a.set("selectedDateModeText",e.menuItem.text),a.get("container").one(".date-mode-menu p").set("text",a.get("selectedDateModeText")),a.isDefaultValue()||a.processUpdate()),a.dropdown.close()})))},handleDateInputFieldChange:function(e){e.halt(),e.target.get("value")||this.handleDateChange()},handleDateChange:function(){var e,t=this.datePickers.from.toString("X");this.datePickers.to.getDate()&&(e=this.datePickers.to.getMoment().add({hours:23,minutes:59,seconds:59}).format("X")),t===this.get("selectedDateFrom")&&e===this.get("selectedDateTo")||(this.set("selectedDateFrom",t),this.set("selectedDateTo",e),this.processUpdate())},processUpdate:function(){var t=this.get("selectedDateMode"),a=this.get("selectedDateFrom"),i=this.get("selectedDateTo"),s="upload"===t?e.SearchHelper.API.minUploadDate:e.SearchHelper.API.minTakenDate,n="upload"===t?e.SearchHelper.API.maxUploadDate:e.SearchHelper.API.maxTakenDate;this.searchUrl.removeAPIParam(e.SearchHelper.API.minTakenDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.maxTakenDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.minUploadDate),this.searchUrl.removeAPIParam(e.SearchHelper.API.maxUploadDate),this.isDefaultValue()||(a&&this.searchUrl.setAPIParam(s,a),i&&this.searchUrl.setAPIParam(n,i)),this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},isDefaultValue:function(){return!(this.get("selectedDateFrom")||this.get("selectedDateTo"))},observePickerPageScroll:function(t){let a;t&&(this.scrollContainer?(a=this.scrollContainer.get("scrollTop"),this.set("startingScrollPoint",a),t.handlerID=this.registerEventHandler(this.scrollContainer.on("scroll",e.betterThrottle((e=>{this.handleScroll.call(this,e,t,this.scrollContainer)}),100,this,!1)))):(a=YUI.Env.isServer?0:e.config.win.pageYOffset,this.set("startingScrollPoint",a),t.handlerID=this.registerEventHandler(e.globalEvents.subscribe("window:scroll",(a=>{this.handleScroll.call(this,a,t,e.Node(document.scrollingElement))})))))},detachPickerPageScroll:function(e){var t;e&&(t=e.handlerID)&&this.detachRegisteredEvent(t)},handleScroll:function(e,t,a){var i,s=this.get("startingScrollPoint");s?(i=a.get("scrollTop"),(s+this.closeOnScrollDistance<i||s-this.closeOnScrollDistance>i)&&t.hide()):this.set("startingScrollPoint",a.get("scrollTop"))},setScrollContainer:function(e){this.scrollContainer=e}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-search-date-picker","search-helper","search-url"],langBundles:["common","search","pika-day"]});