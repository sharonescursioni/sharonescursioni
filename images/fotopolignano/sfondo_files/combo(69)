YUI.add("search-empty-view",(function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var t=a.modelParams&&a.modelParams.apiParams?e.merge(a.modelParams.apiParams):{};this.searchUrl=new e.SearchUrl(t,this.appContext,a.searchType||e.SearchUrl.searchTypes.UNDEFINED),this.searchType=a.searchType,this.isMobile=a.isMobile,""===this.get("container").get("innerHTML")&&this.setContainerHTML("")},buildContainer:function(){var a="search.PHOTOS_PEOPLE_OR_GROUPS";return this.isMobile&&(this.searchType===e.SearchUrl.searchTypes.PHOTOS?a="search.SEARCH_PHOTOS":this.searchType===e.SearchUrl.searchTypes.PEOPLE?a="search.SEARCH_PEOPLE":this.searchType===e.SearchUrl.searchTypes.GROUPS&&(a="search.SEARCH_GROUPS")),a=this.intlMessage({intlName:a}),this.setContainerWithTemplate("search-empty",{searchPlaceholder:a,noMatchesForQuery:this.get("noMatchesForQuery"),apiFailed:this.get("apiFailed")}),this},activate:function(){var a=e.one("#search-field");return a&&setTimeout((function(){let e=a.getDOMNode(),t=e.value.length;e.setSelectionRange(t,t),a.focus()}),1e3),this},enableBlankState:function(e){this.get("container").addClass("blank")},onParentViewEvent:function(e,a){a&&"error-msg-updated"===a[0]&&this.isBuilt&&this.buildContainer()}},{ATTRS:{noMatchesForQuery:{value:!1,validator:function(e,a){return!e||"object"==typeof e&&e.hasOwnProperty("noMatchesText")}},apiFailed:{value:!1,validator:function(a,t){return e.AttributeHelpers.validateBoolean(a)}}}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","search-url","attribute-helpers","hermes-template-search-empty"],langBundles:["search"]});YUI.add("hermes-template-search-photos-album-item",(function(e,l){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,l,a,t,n){var r,s,u=null!=l?l:e.nullContext||{},o=e.hooks.helperMissing,i="function",c=e.escapeExpression,m=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'<a href="'+c(typeof(s=null!=(s=m(a,"url")||(null!=l?m(l,"url"):l))?s:o)===i?s.call(u,{name:"url",hash:{},data:n,loc:{start:{line:1,column:9},end:{line:1,column:16}}}):s)+'" class="search-photos-album-item"><div class="avatar album huge" style="background-image:url('+c(e.lambda(null!=(r=null!=(r=null!=l?m(l,"primaryPhotoSizes"):l)?m(r,"q"):r)?m(r,"src"):r,l))+')">\n\t<sup>'+c(typeof(s=null!=(s=m(a,"title")||(null!=l?m(l,"title"):l))?s:o)===i?s.call(u,{name:"title",hash:{},data:n,loc:{start:{line:2,column:6},end:{line:2,column:15}}}):s)+"</sup>\n\t<sub>"+c((m(a,"intlHTMLMessage")||l&&m(l,"intlHTMLMessage")||o).call(u,{name:"intlHTMLMessage",hash:{count:null!=l?m(l,"photoCount"):l,intlName:"search.GROUP_PHOTO_COUNT"},data:n,loc:{start:{line:3,column:6},end:{line:3,column:78}}}))+"</sub>\n</div></a>"},useData:!0}),t={};e.Array.each([],(function(l){var a=e.Template.get("hermes/"+l);a&&(t[l]=a)})),e.Template.register("hermes/search-photos-album-item",(function(l,n){return(n=n||{}).partials=n.partials?e.merge(t,n.partials):t,a(l,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-search-photos-albums",(function(l,n){var e=l.Template.Handlebars.revive({1:function(l,n,e,t,a){var r,o=null!=n?n:l.nullContext||{},s=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t<h5 class="search-results-header">'+(null!=(r=s(e,"unless").call(o,null!=n?s(n,"loading"):n,{name:"unless",hash:{},fn:l.program(2,a,0),inverse:l.noop,data:a,loc:{start:{line:2,column:35},end:{line:2,column:379}}}))?r:"")+l.escapeExpression((s(e,"intlMessage")||n&&s(n,"intlMessage")||l.hooks.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"search.YOUR_ALBUMS"},data:a,loc:{start:{line:2,column:379},end:{line:2,column:424}}}))+" "+(null!=(r=s(e,"if").call(o,null!=n?s(n,"loading"):n,{name:"if",hash:{},fn:l.program(8,a,0),inverse:l.noop,data:a,loc:{start:{line:2,column:425},end:{line:2,column:485}}}))?r:"")+"</h5>\n"+(null!=(r=s(e,"if").call(o,null!=n?s(n,"loading"):n,{name:"if",hash:{},fn:l.program(10,a,0),inverse:l.program(12,a,0),data:a,loc:{start:{line:3,column:1},end:{line:11,column:8}}}))?r:"")},2:function(l,n,e,t,a){var r,o=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(r=o(e,"if").call(null!=n?n:l.nullContext||{},null!=n?o(n,"viewingAll"):n,{name:"if",hash:{},fn:l.program(3,a,0),inverse:l.program(5,a,0),data:a,loc:{start:{line:2,column:54},end:{line:2,column:368}}}))?r:""},3:function(l,n,e,t,a){var r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'<span class="secondary">'+l.escapeExpression((r(e,"intlHTMLMessage")||n&&r(n,"intlHTMLMessage")||l.hooks.helperMissing).call(null!=n?n:l.nullContext||{},{name:"intlHTMLMessage",hash:{count:null!=n?r(n,"total"):n,intlName:"search.RESULTS_COUNT"},data:a,loc:{start:{line:2,column:96},end:{line:2,column:159}}}))+"</span>"},5:function(l,n,e,t,a){var r,o=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(r=o(e,"unless").call(null!=n?n:l.nullContext||{},null!=n?o(n,"singleResult"):n,{name:"unless",hash:{},fn:l.program(6,a,0),inverse:l.noop,data:a,loc:{start:{line:2,column:174},end:{line:2,column:361}}}))?r:""},6:function(l,n,e,t,a){var r,o=null!=n?n:l.nullContext||{},s=l.hooks.helperMissing,i=l.escapeExpression,u=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'<a href="'+i("function"==typeof(r=null!=(r=u(e,"viewAllLink")||(null!=n?u(n,"viewAllLink"):n))?r:s)?r.call(o,{name:"viewAllLink",hash:{},data:a,loc:{start:{line:2,column:207},end:{line:2,column:222}}}):r)+'" class="view-more-link" data-track="search-viewall-albums">'+i((u(e,"intlHTMLMessage")||n&&u(n,"intlHTMLMessage")||s).call(o,{name:"intlHTMLMessage",hash:{count:null!=n?u(n,"total"):n,intlName:"search.VIEW_ALL_COUNT"},data:a,loc:{start:{line:2,column:282},end:{line:2,column:346}}}))+"</a>"},8:function(l,n,e,t,a){return'<div class="flickr-dots inline"></div>'},10:function(l,n,e,t,a){var r,o=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t<div style="height: '+l.escapeExpression("function"==typeof(r=null!=(r=o(e,"placeholderHeight")||(null!=n?o(n,"placeholderHeight"):n))?r:l.hooks.helperMissing)?r.call(null!=n?n:l.nullContext||{},{name:"placeholderHeight",hash:{},data:a,loc:{start:{line:4,column:22},end:{line:4,column:43}}}):r)+'px;"></div>\n'},12:function(l,n,e,t,a){var r,o,s=null!=n?n:l.nullContext||{},i=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t<div class="results'+(null!=(r=i(e,"unless").call(s,null!=n?i(n,"viewingAll"):n,{name:"unless",hash:{},fn:l.program(13,a,0),inverse:l.noop,data:a,loc:{start:{line:6,column:21},end:{line:6,column:62}}}))?r:"")+'" style="height: '+l.escapeExpression("function"==typeof(o=null!=(o=i(e,"resultsHeight")||(null!=n?i(n,"resultsHeight"):n))?o:l.hooks.helperMissing)?o.call(s,{name:"resultsHeight",hash:{},data:a,loc:{start:{line:6,column:79},end:{line:6,column:96}}}):o)+'px;">\n'+(null!=(r=i(e,"each").call(s,null!=n?i(n,"albums"):n,{name:"each",hash:{},fn:l.program(15,a,0),inverse:l.noop,data:a,loc:{start:{line:7,column:3},end:{line:9,column:12}}}))?r:"")+"\t\t</div>\n"},13:function(l,n,e,t,a){return" unified"},15:function(l,n,e,t,a){var r,o=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(r=l.invokePartial(o(t,"search-photos-album-item"),n,{name:"search-photos-album-item",data:a,indent:"\t\t\t\t",helpers:e,partials:t,decorators:l.decorators}))?r:""},compiler:[8,">= 4.3.0"],main:function(l,n,e,t,a){var r,o=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(r=o(e,"unless").call(null!=n?n:l.nullContext||{},null!=n?o(n,"emptySearch"):n,{name:"unless",hash:{},fn:l.program(1,a,0),inverse:l.noop,data:a,loc:{start:{line:1,column:0},end:{line:12,column:11}}}))?r:""},usePartial:!0,useData:!0}),t={};l.Array.each(["search-photos-album-item"],(function(n){var e=l.Template.get("hermes/"+n);e&&(t[n]=e)})),l.Template.register("hermes/search-photos-albums",(function(n,a){return(a=a||{}).partials=a.partials?l.merge(t,a.partials):t,e(n,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-search-photos-album-item"]});YUI.add("search-photos-albums-view",(function(e,t){var i=require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,emptySearch:!1,initializer:function(t){return""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("search-photos-albums",{loading:!0,placeholderHeight:120}),this.unifiedSubviewParams=t.unifiedSubviewParams||{},this.unifiedSubviewParams.albums&&this.unifiedSubviewParams.albums.fetchParams?(this.fetchParams=this.unifiedSubviewParams.albums.fetchParams,this.apiParams=e.merge(this.fetchParams.apiParams||{}),this.searchId=this.unifiedSubviewParams.albums.id):(this.apiParams={},this.fetchParams={}),this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PHOTOS),this.viewingAll=this.apiParams[e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll],this.albumWidth=0,this.albumMarginWidth=0,this.albumResultsContainer=null,this.pageNum=0,this.initialAlbumModels=[],this},loadState:function(){var e,t=this;return this.appContext.getModel("search-sets-models",this.searchId||this.searchUrl.getId(),this.fetchParams).then((function(i){(e=i.getValue("sets"))&&e.toJSON().length<1&&(t.emptySearch=!0),t.searchModel=i,t.initialAlbumModels=t.searchModel.getValue("sets").getList()}))},buildContainer:function(){var t;return this.searchUrl.setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.albums,!0),this.searchUrl.setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll,!0),t={albums:this.searchModel.getValue("sets").toJSON(),total:this.searchModel.getValue("totalItems"),singleResult:1===this.searchModel.getValue("totalItems"),emptySearch:this.emptySearch,viewAllLink:this.searchUrl.getURL(),viewingAll:this.viewingAll,resultsHeight:this.viewingAll?void 0:130},this.setContainerWithTemplate("search-photos-albums",t),this},activate:function(){var t=this,i=this.get("container"),s=i.one(".album");if(this.albumResultsContainer=i.one(".results"),!this.viewingAll&&s&&(this.albumWidth=s.get("offsetWidth"),this.albumMarginWidth=14,this.albumWidth+=this.albumMarginWidth,this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.quantizeContainerWidth.bind(this))),this.quantizeContainerWidth(null)),this.viewingAll)return this.registerEventHandler(e.globalEvents.subscribe("window:scroll",e.betterThrottle(this.handleScroll.bind(this),100,this,!1))),this.loadMore().then((function(e){var i=(e=e.filter((function(e){return!t.initialAlbumModels.find((function(t){return t.id===e.id}))}))).map((function(e){return e.toJSON()}));return t.appendItems(i)}))},quantizeContainerWidth:function(e){var t,i=this.get("container").get("clientWidth");t=i-i%this.albumWidth+1,this.albumResultsContainer.setStyle("width",t+"px")},handleScroll:function(){var e=this;!this.isLoadingMore&&!this.isAtEnd&&this.albumResultsContainer.getDOMNode().getBoundingClientRect().bottom<this.appContext.viewportData.getHeight()+400&&this.loadMore().then((function(t){var i=t.map((function(e){return e.toJSON()}));e.appendItems(i)}))},loadMore:function(){var t,s=this;if(this.isLoadingMore||this.isAtEnd)return e.Promise.resolve([]);this.isLoadingMore=!0,this.pageNum++,t=Object.assign({},this.unifiedSubviewParams.albums.fetchParams,{page:this.pageNum,perPage:100});var a=e.Node.create('<div class="loader">'),r=s.templates("flickr-balls")({});return a.appendChild(r),s.albumResultsContainer.appendChild(a),this.searchModel.getValue("sets").getPage(t).then((function(e){return s.isLoadingMore=!1,s.isAtEnd=s.searchModel.getValue("sets").size()>=s.searchModel.getValue("totalItems"),a.remove(),e})).catch((function(e){s.pageNum--,s.isLoadingMore=!1,a.remove(),i.error("Error loading more albums",{err:e})}))},appendItems:function(t){var i=this;return t.forEach((function(e){var t=i.templates("search-photos-album-item")(e);i.albumResultsContainer.append(t)})),e.Promise.resolve()}},{ATTRS:{}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","search-sets-models","search-url","search-helper","hermes-template-search-photos-albums","hermes-template-search-photos-album-item","hermes-template-flickr-balls"],optionalRequires:["global-events","hermes-core"],langBundles:["search","common"]});YUI.add("search-photos-yours-view",(function(e){var t={"photo-models":{name:"photo-list-photo-view",params:{excludePeople:!1}},"photo-lite-models":{name:"photo-list-photo-view",params:{excludePeople:!1}}},i={jst:{rowHeight:150,subviewMapping:t},thm:{rowHeight:120,forceAspectRatio:1,subviewMapping:t},til:{rowHeight:210,forceAspectRatio:1,subviewMapping:{"photo-models":{name:"photo-list-tile-view",params:{excludePeople:!1,showDescription:!1}},"photo-lite-models":{name:"photo-list-tile-view",params:{excludePeople:!1,showDescription:!1}}}},desc:{rowHeight:210,itemSpacing:{horizontal:4,vertical:70},subviewMapping:{"photo-models":{name:"photo-list-description-view"},"photo-lite-models":{name:"photo-list-description-view"}}}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,emptySearch:!1,initializer:function(t){var o,s,a,r;return r=t.rowHeightMod||1,"til"===t.viewType&&(r=Math.max(1,t.rowHeightMod)),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("search-photos-single-row",{loading:!0,title:this.intlMessage({intlName:"search.YOUR_PHOTOS"}),placeholderHeight:i[t.viewType].rowHeight*r}),this.unifiedSubviewParams=t.unifiedSubviewParams||{},this.unifiedSubviewParams.yours&&this.unifiedSubviewParams.yours.fetchParams?(this.fetchParams=this.unifiedSubviewParams.yours.fetchParams,this.apiParams=e.merge(this.fetchParams.apiParams||{}),this.searchId=this.unifiedSubviewParams.yours.id,this.title=this.unifiedSubviewParams.yours.title):(this.apiParams={},this.fetchParams={}),this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PHOTOS),o=i[t.viewType].forceAspectRatio,s=e.clone(i[t.viewType].subviewMapping),a=e.clone(i[t.viewType].itemSpacing),t.photoListConfig={modelParams:{registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchId||this.searchUrl.getId(),collectionAttributeName:"photos",fetchParams:this.fetchParams},pageParams:e.merge(this.fetchParams),paginateOnScroll:!1,keepAwakeOnScroll:!0,parentName:this.name,engagementModelName:"photo-lite-models",injectPhotolistContextParams:{rapidBeaconConfig:{beaconName:"searchYourPhotosResultClick",itemIndexKey:"vespaRnk",searchSection:"photos-yours",searchTerm:t.searchTerm}},measureAFT:!0,mobileLayout:t.allowMobileLayout?{}:null,layout:{containerPadding:{top:0,right:0,bottom:0,left:0},targetRowHeight:i[t.viewType].rowHeight*r,maxNumRows:1,alwaysDisplayOrphans:!0}},o&&(t.photoListConfig.layout.forceAspectRatio=o),s&&(t.photoListConfig.subviewMapping=s),a&&(t.photoListConfig.layout.itemSpacing=a),t.viewType===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified&&(t.photoListConfig.layout.itemSpacing={horizontal:4,vertical:4}),this.rowHeightMod=t.rowHeightMod,this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var t=this;return this.apiFailed?e.Promise.resolve():this.appContext.getModel("search-photos-lite-models",this.searchId||this.searchUrl.getId(),this.fetchParams).then((function(e){t.searchModel=e,e.getValue("totalItems")<=0&&(t.emptySearch=!0)}))},buildContainer:function(){return this.setContainerWithTemplate("search-photos-single-row",{emptySearch:this.emptySearch,total:this.searchModel.getValue("totalItems"),singleResult:1===this.searchModel.getValue("totalItems"),viewAll:this.searchUrl.clone().setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll,!0).getURL(),viewAllDataTrack:"search-viewall-user",title:this.title||this.intlMessage({intlName:"search.YOUR_PHOTOS"})}),this},buildHeadContainer:function(){this.set("headContainer",this.subviews["photo-list-view"].get("headContainer"))},activate:function(){return this},onParentViewEvent:function(e,t){if("search:layoutChange"===(t&&t.length&&t[0]))t[1]&&this.handleLayoutChange(t[1])},handleLayoutChange:function(t){var o=this.subviews["photo-list-view"],s=o.photoListLayout,a=i[t].forceAspectRatio,r=e.clone(i[t].subviewMapping),h=this.rowHeightMod;i.hasOwnProperty(t)&&("til"===t&&(h=Math.max(1,h)),s.targetRowHeight=i[t].rowHeight*h,s.forceAspectRatio=a,o.subviewMapping=r,o.setItems(this.searchModel.getValue("photos").getList()))}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-photos-single-row","photo-list-view","search-photos-lite-models","search-helper","person-preferences-models"],langBundles:["search","common"]});YUI.add("search-photos-contacts-view",(function(e){var t={"photo-models":{name:"photo-list-photo-view",params:{excludePeople:!0}},"photo-lite-models":{name:"photo-list-photo-view",params:{excludePeople:!0}}},i={jst:{rowHeight:150,subviewMapping:t},thm:{rowHeight:120,forceAspectRatio:1,subviewMapping:t},til:{rowHeight:210,forceAspectRatio:1,subviewMapping:{"photo-models":{name:"photo-list-tile-view",params:{excludePeople:!0,showDescription:!1}},"photo-lite-models":{name:"photo-list-tile-view",params:{excludePeople:!0,showDescription:!1}}}},desc:{rowHeight:210,itemSpacing:{horizontal:4,vertical:70},subviewMapping:{"photo-models":{name:"photo-list-description-view"},"photo-lite-models":{name:"photo-list-description-view"}}}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,emptySearch:!1,initializer:function(t){var o,s,a,h,r;if(h=t.rowHeightMod||1,"til"===t.viewType&&(h=Math.max(1,t.rowHeightMod)),this.unifiedSubviewParams=t.unifiedSubviewParams||{},this.unifiedSubviewParams.contacts&&this.unifiedSubviewParams.contacts.fetchParams?(this.fetchParams=this.unifiedSubviewParams.contacts.fetchParams,this.apiParams=e.merge(this.fetchParams.apiParams||{}),this.searchId=this.unifiedSubviewParams.contacts.id,this.title=this.unifiedSubviewParams.contacts.title):(this.apiParams={},this.fetchParams={}),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("search-photos-single-row",{loading:!0,title:this.title||this.intlMessage({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"}),placeholderHeight:i[t.viewType].rowHeight*h}),this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PHOTOS),o=i[t.viewType].forceAspectRatio,s=e.clone(i[t.viewType].subviewMapping),a=e.clone(i[t.viewType].itemSpacing),t.photoListConfig={modelParams:{registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchId||this.searchUrl.getId(),collectionAttributeName:"photos",fetchParams:this.fetchParams},pageParams:e.merge(this.fetchParams),paginateOnScroll:!1,keepAwakeOnScroll:!0,parentName:this.name,engagementModelName:"photo-lite-models",injectPhotolistContextParams:{rapidBeaconConfig:{beaconName:"searchContactsPhotoResultClick",itemIndexKey:"vespaRnk",searchSection:"photos-contacts",searchTerm:t.searchTerm}},measureAFT:!0,mobileLayout:t.allowMobileLayout?{}:null,layout:{containerPadding:{top:0,right:0,bottom:0,left:0},targetRowHeight:i[t.viewType].rowHeight*h,maxNumRows:1,alwaysDisplayOrphans:!0}},o&&(t.photoListConfig.layout.forceAspectRatio=o),s&&(t.photoListConfig.subviewMapping=s,t.suppressExcludePeople))for(r in s)t.photoListConfig.subviewMapping[r].params&&(t.photoListConfig.subviewMapping[r].params.excludePeople=!1);return a&&(t.photoListConfig.layout.itemSpacing=a),t.viewType===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified&&(t.photoListConfig.layout.itemSpacing={horizontal:4,vertical:4}),this.rowHeightMod=t.rowHeightMod,this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var t=this;return this.apiFailed?e.Promise.resolve():this.appContext.getModel("search-photos-lite-models",this.searchId||this.searchUrl.getId(),this.fetchParams).then((function(e){t.searchModel=e,e.getValue("totalItems")<=0&&(t.emptySearch=!0)}))},buildContainer:function(){return this.setContainerWithTemplate("search-photos-single-row",{emptySearch:this.emptySearch,total:this.searchModel.getValue("totalItems"),singleResult:1===this.searchModel.getValue("totalItems"),viewAll:this.searchUrl.clone().setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll,!0).getURL(),viewAllDataTrack:"search-viewall-contacts","photo-list-view":this.subviews["photo-list-view"].get("container"),title:this.title||this.intlMessage({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"})}),this},buildHeadContainer:function(){this.set("headContainer",this.subviews["photo-list-view"].get("headContainer"))},activate:function(){return this},onParentViewEvent:function(e,t){if("search:layoutChange"===(t&&t.length&&t[0]))t[1]&&this.handleLayoutChange(t[1])},handleLayoutChange:function(t){var o=this.subviews["photo-list-view"],s=o.photoListLayout,a=i[t].forceAspectRatio,h=e.clone(i[t].subviewMapping),r=this.rowHeightMod;i.hasOwnProperty(t)&&("til"===t&&(r=Math.max(1,r)),s.targetRowHeight=i[t].rowHeight*r,s.forceAspectRatio=a,o.subviewMapping=h,o.setItems(this.searchModel.getValue("photos").getList()))}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-photos-single-row","photo-list-view","search-photos-lite-models","search-helper","person-preferences-models"],langBundles:["search","common"]});YUI.add("search-photos-prints-view",(function(e){var t={"photo-models":{name:"photo-list-photo-view"},"photo-lite-models":{name:"photo-list-photo-view"}},i={jst:{rowHeight:150,subviewMapping:t},thm:{rowHeight:120,forceAspectRatio:1,subviewMapping:t},til:{rowHeight:210,forceAspectRatio:1,subviewMapping:{"photo-models":{name:"photo-list-tile-view"},"photo-lite-models":{name:"photo-list-tile-view"}}}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,emptySearch:!1,initializer:function(t){var o,s,a,r;return r=t.rowHeightMod||1,"til"===t.viewType&&(r=Math.max(1,t.rowHeightMod)),this.unifiedSubviewParams=t.unifiedSubviewParams||{},this.unifiedSubviewParams.prints&&this.unifiedSubviewParams.prints.fetchParams?(this.fetchParams=this.unifiedSubviewParams.prints.fetchParams,this.apiParams=e.merge(this.fetchParams.apiParams||{}),this.searchId=this.unifiedSubviewParams.prints.id):(this.apiParams={},this.fetchParams={}),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("search-photos-single-row",{loading:!0,title:this.intlMessage({intlName:"prints.FROM_THE_PRINT_SHOP"}),placeholderHeight:i[t.viewType].rowHeight*r,showBetaLabel:!0}),this.searchUrl="/prints/discover",o=i[t.viewType].forceAspectRatio,s=e.clone(i[t.viewType].subviewMapping),a=e.clone(i[t.viewType].itemSpacing),t.photoListConfig={modelParams:{registryName:"group-pool-models",modelIdOrAttributes:this.searchId,collectionAttributeName:"photoPageList",fetchParams:this.fetchParams},pageParams:e.merge(this.fetchParams),paginateOnScroll:!1,keepAwakeOnScroll:!0,parentName:this.name,engagementModelName:"photo-lite-models",measureAFT:!0,mobileLayout:t.allowMobileLayout?{}:null,layout:{containerPadding:{top:0,right:0,bottom:0,left:0},targetRowHeight:i[t.viewType].rowHeight*r,maxNumRows:1,alwaysDisplayOrphans:!0},injectPhotolistContextParams:{rapidBeaconConfig:{searchSection:"print-shop",searchTerm:t.searchTerm}}},o&&(t.photoListConfig.layout.forceAspectRatio=o),s&&(t.photoListConfig.subviewMapping=s),a&&(t.photoListConfig.layout.itemSpacing=a),t.viewType===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified&&(t.photoListConfig.layout.itemSpacing={horizontal:4,vertical:4}),this.rowHeightMod=t.rowHeightMod,this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var t=this;return this.apiFailed?e.Promise.resolve():this.appContext.getModel("group-pool-models",this.searchId,this.fetchParams).then((function(e){t.searchModel=e,e.getValue("poolCount")<=0&&(t.emptySearch=!0)}))},buildContainer:function(){return this.setContainerWithTemplate("search-photos-single-row",{emptySearch:this.emptySearch,total:this.searchModel.getValue("poolCount"),singleResult:1===this.searchModel.getValue("poolCount"),viewAll:this.searchUrl,"photo-list-view":this.subviews["photo-list-view"].get("container"),title:this.intlMessage({intlName:"prints.FROM_THE_PRINT_SHOP"}),showBetaLabel:!0}),this},buildHeadContainer:function(){this.set("headContainer",this.subviews["photo-list-view"].get("headContainer"))},activate:function(){return this},onParentViewEvent:function(e,t){if("search:layoutChange"===(t&&t.length&&t[0]))t[1]&&this.handleLayoutChange(t[1])},handleLayoutChange:function(t){var o=this.subviews["photo-list-view"],s=o.photoListLayout,a=i[t].forceAspectRatio,r=e.clone(i[t].subviewMapping),h=this.rowHeightMod;i.hasOwnProperty(t)&&("til"===t&&(h=Math.max(1,h)),s.targetRowHeight=i[t].rowHeight*h,s.forceAspectRatio=a,o.subviewMapping=r,o.setItems(this.searchModel.getValue("photoPageList").getList()))}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-photos-single-row","photo-list-view","search-photos-lite-models","search-helper","person-preferences-models"],langBundles:["search","common","prints"]});