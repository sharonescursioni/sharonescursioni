YUI.add("hermes-template-scrappy-edit-button",(function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,a,r){var l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t<div class=\'edit\'>\n\t\t<a href="#" title="'+e.escapeExpression((l(n,"intlMessage")||t&&l(t,"intlMessage")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.EDIT_PHOTO"},data:r,loc:{start:{line:3,column:21},end:{line:3,column:77}}}))+'" class="button">\n\t\t\t<i class="ui-icon-edit"></i>\n\t\t</a>\n\t</div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,r){var l,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(l=i(n,"if").call(null!=t?t:e.nullContext||{},null!=t?i(t,"viewerIsOwner"):t,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r,loc:{start:{line:1,column:0},end:{line:7,column:7}}}))?l:""},useData:!0}),a={};e.Array.each([],(function(t){var n=e.Template.get("hermes/"+t);n&&(a[t]=n)})),e.Template.register("hermes/scrappy-edit-button",(function(t,r){return(r=r||{}).partials=r.partials?e.merge(a,r.partials):a,n(t,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-scrappy-edit-menu",(function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return(null!=(o=i(l,"if").call(r,null!=e?i(e,"enableEdit"):e,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.program(4,a,0),data:a,loc:{start:{line:5,column:2},end:{line:9,column:9}}}))?o:"")+"\t\t\t"+n.escapeExpression((i(l,"intlMessage")||e&&i(e,"intlMessage")||n.hooks.helperMissing).call(r,{name:"intlMessage",hash:{intlName:"photo-editor.EDIT"},data:a,loc:{start:{line:10,column:3},end:{line:10,column:47}}}))+"\n\t\t\t</a></li>\n"},2:function(n,e,l,t,a){return'\t\t\t<li><a href="#" class="edit-photo">\n'},4:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t\t<li><a href="#" class="unavailable-feature '+(null!=(o=i(l,"if").call(r,null!=e?i(e,"isVideo"):e,{name:"if",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:46},end:{line:8,column:75}}}))?o:"")+'" '+(null!=(o=i(l,"if").call(r,null!=e?i(e,"isVideo"):e,{name:"if",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:77},end:{line:8,column:175}}}))?o:"")+">\n"},5:function(n,e,l,t,a){return"isVideo"},7:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'title="'+n.escapeExpression((o(l,"intlMessage")||e&&o(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.NO_VIDEOS_IN_EDITOR"},data:a,loc:{start:{line:8,column:99},end:{line:8,column:164}}}))+'"}}"'},9:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<li><a href="#" class="rotate-photo '+(null!=(o=i(l,"if").call(r,null!=e?i(e,"isVideo"):e,{name:"if",hash:{},fn:n.program(10,a,0),inverse:n.noop,data:a,loc:{start:{line:15,column:38},end:{line:15,column:87}}}))?o:"")+'" '+(null!=(o=i(l,"if").call(r,null!=e?i(e,"isVideo"):e,{name:"if",hash:{},fn:n.program(12,a,0),inverse:n.noop,data:a,loc:{start:{line:15,column:89},end:{line:15,column:182}}}))?o:"")+">\n\t\t\t"+n.escapeExpression((i(l,"intlMessage")||e&&i(e,"intlMessage")||n.hooks.helperMissing).call(r,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ROTATE"},data:a,loc:{start:{line:16,column:3},end:{line:16,column:55}}}))+"\n\t\t</a></li>\n"},10:function(n,e,l,t,a){return"isVideo unavailable-feature"},12:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'title="'+n.escapeExpression((o(l,"intlMessage")||e&&o(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.NO_VIDEO_ROTATION"},data:a,loc:{start:{line:15,column:111},end:{line:15,column:174}}}))+'"'},14:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<li><a href="#" class="replace-photo '+(null!=(o=i(l,"if").call(r,null!=e?i(e,"isVideo"):e,{name:"if",hash:{},fn:n.program(10,a,0),inverse:n.noop,data:a,loc:{start:{line:21,column:39},end:{line:21,column:88}}}))?o:"")+'" '+(null!=(o=i(l,"if").call(r,null!=e?i(e,"isVideo"):e,{name:"if",hash:{},fn:n.program(15,a,0),inverse:n.noop,data:a,loc:{start:{line:21,column:90},end:{line:21,column:182}}}))?o:"")+">\n\t\t\t"+n.escapeExpression((i(l,"intlMessage")||e&&i(e,"intlMessage")||n.hooks.helperMissing).call(r,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.REPLACE"},data:a,loc:{start:{line:22,column:3},end:{line:22,column:56}}}))+"\n\t\t</a></li>\n"},15:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'title="'+n.escapeExpression((o(l,"intlMessage")||e&&o(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.NO_VIDEO_REPLACE"},data:a,loc:{start:{line:21,column:112},end:{line:21,column:174}}}))+'"'},17:function(n,e,l,t,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<li><a href="#" class="delete-photo">\n\t\t\t'+n.escapeExpression((o(l,"intlMessage")||e&&o(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.DELETE"},data:a,loc:{start:{line:30,column:3},end:{line:30,column:43}}}))+"\n\t\t</a></li>\n"},compiler:[8,">= 4.3.0"],main:function(n,e,l,t,a){var o,r=null!=e?e:n.nullContext||{},i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"<ul>\n\n"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"showEditLink"):e,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:4,column:1},end:{line:12,column:9}}}))?o:"")+"\n"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"showRotateLink"):e,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:14,column:1},end:{line:18,column:8}}}))?o:"")+"\n"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"showReplaceLink"):e,{name:"if",hash:{},fn:n.program(14,a,0),inverse:n.noop,data:a,loc:{start:{line:20,column:1},end:{line:24,column:8}}}))?o:"")+"\n\n"+(null!=(o=i(l,"if").call(r,null!=e?i(e,"showDeleteLink"):e,{name:"if",hash:{},fn:n.program(17,a,0),inverse:n.noop,data:a,loc:{start:{line:28,column:1},end:{line:32,column:8}}}))?o:"")+"\n</ul>\n"},useData:!0}),t={};n.Array.each([],(function(e){var l=n.Template.get("hermes/"+e);l&&(t[e]=l)})),n.Template.register("hermes/scrappy-edit-menu",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,l(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-replace-photo-dialog-content",(function(e,n){var t=e.Template.Handlebars.revive({1:function(e,n,t,l,a){var o,r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(o=r(t,"if").call(null!=n?n:e.nullContext||{},null!=n?r(n,"uploading"):n,{name:"if",hash:{},fn:e.program(2,a,0),inverse:e.program(4,a,0),data:a,loc:{start:{line:3,column:2},end:{line:8,column:9}}}))?o:""},2:function(e,n,t,l,a){var o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"\t\t\t"+e.escapeExpression((o(t,"intlHTMLMessage")||n&&o(n,"intlHTMLMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlHTMLMessage",hash:{fileName:null!=n?o(n,"fileName"):n,intlName:"photo-page-scrappy.REPLACE_UPLOADING"},data:a,loc:{start:{line:4,column:3},end:{line:4,column:88}}}))+'\n\t\t\t<progress min="0" max="100" value="0"></progress>\n'},4:function(e,n,t,l,a){var o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"\t\t\t"+e.escapeExpression((o(t,"intlHTMLMessage")||n&&o(n,"intlHTMLMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlHTMLMessage",hash:{fileName:null!=n?o(n,"fileName"):n,username:null!=n?o(n,"username"):n,photoTitle:null!=n?o(n,"photoTitle"):n,intlName:"photo-page-scrappy.PERMANENTLY_REPLACE"},data:a,loc:{start:{line:7,column:3},end:{line:7,column:130}}}))+"\n"},6:function(e,n,t,l,a){var o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"\t\t"+e.escapeExpression((o(t,"intlMessage")||n&&o(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.REPLACE_WARNING"},data:a,loc:{start:{line:10,column:2},end:{line:10,column:63}}}))+"\n"},8:function(e,n,t,l,a){var o,r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(o=r(t,"unless").call(null!=n?n:e.nullContext||{},null!=n?r(n,"uploading"):n,{name:"unless",hash:{},fn:e.program(9,a,0),inverse:e.noop,data:a,loc:{start:{line:15,column:2},end:{line:17,column:13}}}))?o:""},9:function(e,n,t,l,a){var o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t\t\t<button class="butt" data-action="submit">'+e.escapeExpression((o(t,"intlMessage")||n&&o(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.REPLACE"},data:a,loc:{start:{line:16,column:45},end:{line:16,column:98}}}))+"</button>\n"},11:function(e,n,t,l,a){var o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t\t<button class="butt">\n\t\t\t<input type="file" name="file" accept="image/*">\n\t\t\t'+e.escapeExpression((o(t,"intlMessage")||n&&o(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"common.CHOOSE_FILE"},data:a,loc:{start:{line:21,column:3},end:{line:21,column:48}}}))+"\n\t\t</button>\n"},compiler:[8,">= 4.3.0"],main:function(e,n,t,l,a){var o,r=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="replace-photo-uploading">\n'+(null!=(o=s(t,"if").call(r,null!=n?s(n,"fileName"):n,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.program(6,a,0),data:a,loc:{start:{line:2,column:1},end:{line:11,column:8}}}))?o:"")+'</div>\n<div class="replace-photo-buttons">\n'+(null!=(o=s(t,"if").call(r,null!=n?s(n,"fileName"):n,{name:"if",hash:{},fn:e.program(8,a,0),inverse:e.program(11,a,0),data:a,loc:{start:{line:14,column:1},end:{line:23,column:8}}}))?o:"")+"</div>\n"},useData:!0}),l={};e.Array.each([],(function(n){var t=e.Template.get("hermes/"+n);t&&(l[n]=t)})),e.Template.register("hermes/replace-photo-dialog-content",(function(n,a){return(a=a||{}).partials=a.partials?e.merge(l,a.partials):l,t(n,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-rotate-photo-dialog-content",(function(t,e){var a=t.Template.Handlebars.revive({1:function(t,e,a,l,n){return"c-rotations-portrait"},compiler:[8,">= 4.3.0"],main:function(t,e,a,l,n){var r,i=t.lambda,o=t.escapeExpression,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="rotate-photo-dialog-container">\n\t<ul class="c-rotations '+(null!=(r=(s(a,"ifCond")||e&&s(e,"ifCond")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},null!=(r=null!=e?s(e,"preview"):e)?s(r,"width"):r,"<",null!=(r=null!=e?s(e,"preview"):e)?s(r,"height"):r,{name:"ifCond",hash:{},fn:t.program(1,n,0),inverse:t.noop,data:n,loc:{start:{line:2,column:24},end:{line:2,column:99}}}))?r:"")+'">\n\t\t<li><img class="ui-util-rotate-90" src="'+o(i(null!=(r=null!=e?s(e,"preview"):e)?s(r,"url"):r,e))+'" data-action="select" data-rotation="90"></li>\n\t\t<li><img class="ui-util-rotate-180" src="'+o(i(null!=(r=null!=e?s(e,"preview"):e)?s(r,"url"):r,e))+'" data-action="select" data-rotation="180"></li>\n\t\t<li><img class="ui-util-rotate-270" src="'+o(i(null!=(r=null!=e?s(e,"preview"):e)?s(r,"url"):r,e))+'" data-action="select" data-rotation="270"></li>\n\t</ul>\n</div>\n'},useData:!0}),l={};t.Array.each([],(function(e){var a=t.Template.get("hermes/"+e);a&&(l[e]=a)})),t.Template.register("hermes/rotate-photo-dialog-content",(function(e,n){return(n=n||{}).partials=n.partials?t.merge(l,n.partials):l,a(e,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-well-scrappy-edit-view",(function(e,t){var o=require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.backToURL=e.backToURL,this.context=e.context,""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("scrappy-edit-button",{loadingView:!0}),this.editorParams={nsid:this.nsid,photoId:this.photoId,backToURL:this.backToURL},this},loadState:function(){var t=this;return this.appContext.getViewer().signedIn?e.Promise.all([this.appContext.getModel("photo-models",t.photoId)]).then((function(o){var i=o[0];if(t.set("photo",i),i.getValue("owner").getValue("isMe")&&!t.appContext.forceServerRender)return t.appContext.getModel(t.context.modelName,t.context.params).then((function(e){t.set("contextModel",e)})).then((function(){var o=e.merge(t.context.params,{photoId:t.photoId,numNext:1,numPrev:1});return t.get("contextModel").getValue("photoContextList").getContext(o).then((function(){var e,o=t.get("contextModel").getValue("photoContextList").getList(),i=o.length;(e=o.map((function(e){return e.getValue("id")})).indexOf(t.photoId))>=0&&e<i&&t.set("nextPhotoModel",o[e+1]),e>0&&t.set("prevPhotoModel",o[e-1])}))}))})):e.Promise.resolve()},buildContainer:function(){var e=!1;return this.appContext.getViewer().signedIn&&(e=this.get("photo").getValue("owner").getValue("isMe")),this.setContainerWithTemplate("scrappy-edit-button",{viewerIsOwner:e}),this},activate:function(){var e=this.get("container");return e&&this.registerEventHandler(e.on("click",this.handleMenuButtonClick,this)),this},setupDropdown:function(t){var o,i,n=this.get("container"),a=this.get("photo"),l=a.getValue("owner").getValue("isMe"),s=!1,r=a.getValue("isVideo"),h=a.getValue("id");l&&(s=!0),o=e.URLHelper.getPhotoPage({photoId:a.getValue("id"),pathAlias:a.getValue("owner").getValue("pathAlias")}),i=this.templates("scrappy-edit-menu")({photoURL:o,photoId:h,viewerIsOwner:l,showDeleteLink:l,showRotateLink:l&&!r,showReplaceLink:l&&!r,isVideo:r,showEditLink:l&&!r,enableEdit:s}),this.editMenu&&(this.editMenu.close(),this.editMenu=null),this.editMenu=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,preferTop:!0,showDropArrow:!0,anchorOffsetVertical:10,width:170,anchorElement:n.one(".edit"),htmlMessage:i,closeOnScroll:!1,classList:"dialog-tooltip",autoSizeToContent:!0}),this.editMenu.on("activated",(function(o){e.use("photo-editor-view",t)})),this.editMenu.show()},handleMenuButtonClick:function(t){var o=this;t.preventDefault(),e.rapidTracker.beacon(this.name,"editMenuClick"),this.appContext.experiments.fullscreen.getMode()||this.setupDropdown((function(){var e={},t=o.editMenu.get("container");o.appContext.auth.signedIn&&(e.deleteMenuItem=t.one(".delete-photo"),e.deleteMenuItem&&e.deleteMenuItem.on("click",o.handleDeletePhotoClick,o),e.rotateMenuItem=t.one(".rotate-photo"),e.rotateMenuItem&&e.rotateMenuItem.on("click",o.handleRotatePhotoClick,o),e.replaceMenuItem=t.one(".replace-photo"),e.replaceMenuItem&&e.replaceMenuItem.on("click",o.handleReplacePhotoClick,o),e.editorMenuItem=t.one(".edit-photo"),e.editorMenuItem&&e.editorMenuItem.on("click",o.handleEditClick,o))}))},handleDeletePhotoClick:function(t){var o;t.preventDefault(),this.editMenu.close(),(o=new e.Views.FluidModal({title:this.intlMessage({intlName:"photo-page-scrappy.DELETE_PHOTO"}),actionButtonLabel:this.intlMessage({intlName:"common.DELETE"}),actionButtonIsDangerous:!0,htmlMessage:this.intlMessage({intlName:"photo-page-scrappy.PERMANTENTLY_DELETE"}),appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,showCancelX:!0})).on("actionClick",this.handleDeletePhotoConfirmClick.bind(this)),o.show(),e.rapidTracker.beacon(this.name,"deletePhotoClick")},handleDeletePhotoConfirmClick:function(t){var o,i=this,n=i.get("photo").getValue("owner"),a=i.get("nextPhotoModel"),l=i.get("prevPhotoModel");e.rapidTracker.beacon(this.name,"deletePhotoConfirmationClick"),i.deleteDialog&&i.deleteDialog.close(),this.appContext.callAPI("flickr.photos.delete",{photo_id:this.photoId}).then((function(t){o=a?e.URLHelper.getPhotoPage({photoId:a.getValue("id"),pathAlias:a.getValue("owner").getValue("pathAlias"),contextSuffix:i.get("contextModel").getValue("urlSuffix")}):l?e.URLHelper.getPhotoPage({photoId:l.getValue("id"),pathAlias:l.getValue("owner").getValue("pathAlias"),contextSuffix:i.get("contextModel").getValue("urlSuffix")}):n.getValue("url")+"?deleted="+i.photoId,e.config.win.location=o}),(function(e){i.showErrorDialog(i.intlMessage({intlName:"photo-page-scrappy.ERROR_DELETING_PHOTO"}))}))},handleReplacePhotoClick:function(t){t.halt();var o=this;this.get("photo").getValue("isVideo")||(this.editMenu.close(),this.replaceDialog=new e.Views.FluidModal({appContext:this.appContext,htmlMessage:this.templates("replace-photo-dialog-content")(),title:this.intlMessage({intlName:"photo-page-scrappy.REPLACE_PHOTO"}),showCancelX:!0,dismissOnOverlayClick:!0,showFooter:!1,width:700}),this.replaceDialog.attachEvents({"input change:":function(e){e.halt();var t=e.target.getDOMNode().files[0];t&&(o._imgFile=t,o.replaceConfirm())},":submit":function(){o.replaceSubmit()}}),this.replaceDialog.on("close",(function(){o._imgFileXhr&&o._imgFileXhr.abort(),o._imgFileXhr=null,o._imgFile=null,this.replaceDialog=null})),this.replaceDialog.show(),e.rapidTracker.beacon(this.name,"replacePhotoClick"))},replaceConfirm:function(){this.replaceDialog.set("htmlMessage",this.templates("replace-photo-dialog-content")({fileName:this._imgFile.name})),this.replaceDialog.buildContainer(),this.replaceDialog.activate(),e.rapidTracker.beacon(this.name,"replacePhotoConfirmationClick")},replaceSubmit:function(){var t,i,n,a,l=new FormData,s=this,r=e.config.flickr.api.hostname_client_replace;l.append("api_key",e.SiteKey.getKey()),l.append("csrf",e.config.flickr.csrf.token),l.append("photo",this._imgFile,this._imgFile.name),l.append("photo_id",this.photoId),(t=this._imgFileXhr=new XMLHttpRequest).open("POST",r,!0),t.withCredentials=!0,n=function(i){var n="object"==typeof i?i.target.statusText:i+"",a="ERROR_REPLACING_PHOTO";s.replaceDialog.close(),t.statusText.indexOf("Filetype was not recognised")>0&&(a="ERROR_REPLACING_PHOTO_FILE_TYPE"),s.showErrorDialog(s.intlMessage({intlName:"photo-page-scrappy."+a})),e.config.win.beaconError("Replace error",window.location.href,{err:i,status:t.statusText}),o.error("error during upload",{statusText:n})},a=function(o){var i,a,l;try{(l=document.createElement("div")).innerHTML=o.target.responseText,(a=l.getElementsByTagName("rsp")[0]||"")&&(a=a.getAttribute("stat")||""),(i=l.getElementsByTagName("err")[0]||"")&&(i=i.getAttribute("msg")||"")}catch(e){a="",i=""}if("ok"!==a)return e.config.win.beaconError("Replace error from API response",window.location.href,{err:o.target.responseText,status:t.statusText}),n((a||"empty")+": "+(i||"no message"));s.replaceDialog.close(),window.location.reload()},this.replaceDialog.set("htmlMessage",this.templates("replace-photo-dialog-content")({fileName:this._imgFile.name,uploading:!0})),this.replaceDialog.buildContainer(),this.replaceDialog.activate(),i=this.replaceDialog.get("container").one("progress"),t.addEventListener("load",a),t.addEventListener("error",n),t.upload.addEventListener("progress",(function(e){i.value=Math.floor(e.loaded/e.total*100),e.loaded===e.total&&i.removeAttribute("value")})),t.send(l)},handleRotatePhotoClick:function(t){t.halt();var o=this;this.get("photo").getValue("isVideo")||(this.editMenu.close(),this.rotateDialog=new e.Views.FluidModal({appContext:this.appContext,htmlMessage:this.templates("rotate-photo-dialog-content")({preview:o.get("photo").getSizeToFit({width:240,height:240})}),title:this.intlMessage({intlName:"photo-page-scrappy.ROTATE_PHOTO"}),dismissOnOverlayClick:!0,showCancelX:!0,actionButtonLabel:this.intlMessage({intlName:"photo-page-scrappy.ROTATE_PHOTO"}),dismissOnActionClick:!1,showCancelButton:!1,width:700}),this.registerEventHandler(this.rotateDialog.on("actionClick",(()=>{this.rotateSubmit()}))),this.rotateDialog.attachEvents({":select":function(t,i){t.target.ancestor(".c-rotations").all("img").removeClass("c-state-selected"),t.target.addClass("c-state-selected"),o._imgRotation=e.flutil.constrainToValues(i.rotation,["90","180","270"])}}),this.rotateDialog.on("close",(function(){o.rotateDialog=null})),this.rotateDialog.show(),e.rapidTracker.beacon(this.name,"rotatePhotoClick"))},rotateSubmit:function(){var t,i=this,n=this.rotateDialog;n&&n.get("container")&&(t=n.get("container").one(".button-container"))&&t.prepend(this.templates("flickr-balls")({})),this.appContext.callAPI("flickr.photos.transform.rotate",{photo_id:this.photoId,degrees:this._imgRotation||90}).then((function(){setTimeout((function(){n.close(),i.fire("subviewViewEvent","photo:reload")}),2e3)}),(function(a){n&&n.get("container")&&(t=n.get("container").one(".button-container"))&&t.removeClass("loading"),n.close(),i.showErrorDialog(i.intlMessage({intlName:"photo-page-scrappy.ERROR_ROTATING_PHOTO"})),e.config.win.beaconError("Rotation error",window.location.href,a),o.error("error during rotation",{err:a})})),e.rapidTracker.beacon(this.name,"rotatePhotoConfirmationClick")},handleEditClick:function(t){t.halt(),this.editMenu.close(),this.appContext.getView("photo-editor-view",this.editorParams).then((function(e){return e.initialize().then((function(){e.activate()}))})),e.Analytics.sendClick("photo-editor-open-click"),e.rapidTracker.beacon(this.name,"editPhoto")},showErrorDialog:function(t){return this.errorDialog=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,title:this.intlMessage({intlName:"common.OOPS"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t}),this.errorDialog.show(),this.errorDialog}})}),"@VERSION@",{requires:["flickr-view","flutil","flickr-promise","fluid-modal-view","fluid-droparound-view","hermes-template-scrappy-edit-button","hermes-template-scrappy-edit-menu","hermes-template-replace-photo-dialog-content","hermes-template-rotate-photo-dialog-content","hermes-template-flickr-balls","site-key"],optionalRequires:["hermes-core"],optional:[],langBundles:["common","photo-page-scrappy","photo-editor"]});YUI.add("hermes-lang-photo-editor_it-it",(function(e,a){e.Intl.add("hermes/photo-editor","it-IT",{FILTERS:[{type:0,value:"Filtri"}],ORIENTATION:[{type:0,value:"Orientamento"}],ADJUST:[{type:0,value:"Regola"}],CROP:[{type:0,value:"Ritaglia"}],FOCUS:[{type:0,value:"Metti a fuoco"}],SELECTIVE_BLUR:[{type:0,value:"Sfocatura selettiva"}],BORDER:[{type:0,value:"Bordo"}],STICKER:[{type:0,value:"Adesivo"}],TEXT:[{type:0,value:"Testo"}],BRUSH:[{type:0,value:"Pennello"}],FRAMES:[{type:0,value:"Cornici"}],BORDER_COLOR:[{type:0,value:"Colore"}],BORDER_THICKNESS:[{type:0,value:"Spessore"}],TEXT_FOREGROUND:[{type:0,value:"Primo piano"}],TEXT_BACKGROUND:[{type:0,value:"Sfondo"}],TEXT_SIZE:[{type:0,value:"Dimensione"}],TEXT_FONT:[{type:0,value:"Tipo di carattere"}],TEXT_ALIGNMENT:[{type:0,value:"Allineamento"}],TEXT_TO_FRONT:[{type:0,value:"Porta in primo piano"}],TEXT_DEFAULT_TEXT:[{type:0,value:"Clicca per modificare"}],ORIENTATION_MINUS_90:[{type:0,value:"Ruota di -90°"}],ORIENTATION_PLUS_90:[{type:0,value:"Ruota di +90°"}],ORIENTATION_FLIP_H:[{type:0,value:"Capovolgi (O)"}],ORIENTATION_FLIP_V:[{type:0,value:"Capovolgi (V)"}],ADJUSTMENTS_BRIGHTNESS:[{type:0,value:"Luminosità"}],ADJUSTMENTS_CONTRAST:[{type:0,value:"Contrasto"}],ADJUSTMENTS_SATURATION:[{type:0,value:"Saturazione"}],ADJUSTMENTS_EXPOSURE:[{type:0,value:"Esposizione"}],ADJUSTMENTS_SHADOWS:[{type:0,value:"Ombre"}],ADJUSTMENTS_HIGHLIGHTS:[{type:0,value:"Alte luci"}],ADJUSTMENTS_CLARITY:[{type:0,value:"Nitidezza"}],ADJUSTMENTS_GAMMA:[{type:0,value:"Gamma"}],CROP_CUSTOM:[{type:0,value:"Personalizzato"}],CROP_SQUARE:[{type:0,value:"Quadrato"}],CROP_4_3:[{type:0,value:"4:3"}],CROP_16_9:[{type:0,value:"16:9"}],CROP_NONE:[{type:0,value:"Nessuno"}],CROP_ROTATION:[{type:0,value:"Rotazione"}],FOCUS_RADIAL:[{type:0,value:"Radiale"}],FOCUS_LINEAR:[{type:0,value:"Lineare"}],FOCUS_BLUR_RADIUS:[{type:0,value:"Raggio sfocatura"}],FOCUS_NONE:[{type:0,value:"Nessuna"}],FILTERS_INTENSITY:[{type:0,value:"Intensità"}],FILTERS_CATEGORIES_ALL:[{type:0,value:"TUTTO"}],FILTERS_CATEGORIES_RETRO:[{type:0,value:"ANTICO"}],FILTERS_CATEGORIES_BW:[{type:0,value:"Bianco e nero"}],FILTERS_CATEGORIES_SUMMER:[{type:0,value:"Estate"}],FILTERS_CATEGORIES_WINTER:[{type:0,value:"Inverno"}],FILTERS_CATEGORIES_SPECIAL:[{type:0,value:"Speciale"}],STICKERS_BRIGHTNESS:[{type:0,value:"Luminosità"}],STICKERS_CONTRAST:[{type:0,value:"Contrasto"}],STICKERS_SATURATION:[{type:0,value:"Saturazione"}],STICKERS_BLUR:[{type:0,value:"Sfoca"}],STICKERS_FLIP:[{type:0,value:"Capovolgi"}],STICKERS_FLIP_V:[{type:0,value:"Capovolgi (V)"}],STICKERS_FLIP_H:[{type:0,value:"Capovolgi (O)"}],STICKERS_TO_FRONT:[{type:0,value:"Porta in primo piano"}],STICKERS_CATEGORIES_ALL:[{type:0,value:"Tutto"}],STICKERS_CATEGORIES_GLASSES:[{type:0,value:"Occhiali"}],STICKERS_CATEGORIES_HATS:[{type:0,value:"Cappelli"}],STICKERS_CATEGORIES_BEARDS:[{type:0,value:"Barbe"}],STICKERS_CATEGORIES_MISC:[{type:0,value:"Altro"}],BRUSH_THICKNESS:[{type:0,value:"Spessore"}],BRUSH_COLOR:[{type:0,value:"Colore"}],WEBCAM_TAKE_PHOTO:[{type:0,value:"Scatta una foto!"}],EDITOR_EDIT_PHOTO:[{type:0,value:"Modifica foto"}],EDITOR_NEW:[{type:0,value:"Nuova"}],EDITOR_PHOTO_ROLL:[{type:0,value:"Rullino foto"}],EDITOR_UNDO:[{type:0,value:"Annulla"}],EDITOR_EXPORT:[{type:0,value:"Salva"}],EDITOR_ZOOM:[{type:0,value:"Zoom"}],SPLASH_UPLOAD:[{type:0,value:"Carica la tua immagine"}],SPLASH_UPLOAD_DESCRIPTION:[{type:0,value:"Carica un’immagine dalla tua libreria o trascinala"}],SPLASH_WEBCAM:[{type:0,value:"Webcam"}],SPLASH_WEBCAM_DESCRIPTION:[{type:0,value:"Scatta una foto dalla webcam o dal telefono"}],SPLASH_STOCK:[{type:0,value:"Rullino foto di stock gratuite"}],SPLASH_STOCK_DESCRIPTION:[{type:0,value:"Scegli tra migliaia di foto di stock gratuite"}],STOCK_SEARCH:[{type:0,value:"Cerca foto"}],STOCK_SEARCH_RESULTS:[{type:0,value:"Risultati di ricerca per "},{type:1,value:"query"}],BUTTONS_BACK:[{type:0,value:"Indietro"}],BUTTONS_CANCEL:[{type:0,value:"Annulla"}],BUTTONS_COLOR:[{type:0,value:"Colore"}],LOADING_RESIZING:[{type:0,value:"Ridimensionamento in corso..."}],LOADING_EXPORTING:[{type:0,value:"Salvataggio in corso..."}],LOADING_LOADING:[{type:0,value:"Caricamento in corso..."}],WARNINGS_RESIZED:[{type:0,value:"Immagine ridimensionata"}],WARNINGS_MAX_SIZE:[{type:0,value:"La tua immagine ha raggiunto le dimensioni massime di "},{type:1,value:"maxMegaPixels"},{type:0,value:" megapixel e pertanto è stata ridimensionata a "},{type:1,value:"width"},{type:0,value:"x"},{type:1,value:"height"},{type:0,value:" pixel."}],WARNINGS_LIMIT_SIZE:[{type:0,value:"A causa delle limitazioni di hardware, la tua immagine è stata ridimensionata a "},{type:1,value:"width"},{type:0,value:"x"},{type:1,value:"height"},{type:0,value:" pixel."}],ERRORS_LOADING:[{type:0,value:"Impossibile caricare l’immagine"}],ERRORS_LOADING_MESSAGE:[{type:0,value:"Impossibile caricare l’immagine su "},{type:1,value:"path"}],ERRORS_WEBCAM_UNAVAILABLE:[{type:0,value:"Webcam non disponibile"}],ERRORS_WEBCAM_UNAVAILABLE_MESSAGE:[{type:0,value:"Impossibile visualizzare l’immagine della webcam (Errore: "},{type:1,value:"error"},{type:0,value:")"}],ERRORS_WEBCAM_NOT_SUPPORTED:[{type:0,value:"Webcam non supportata"}],ERRORS_WEBCAM_NOT_SUPPORTED_MESSAGE:[{type:0,value:"La funzione webcam non è supportata dal tuo browser."}],ERRORS_RENDER:[{type:0,value:"Errore durante il rendering"}],ERRORS_RENDER_MESSAGE:[{type:0,value:"Si è verificato un errore durante il rendering dell’immagine."}],ERRORS_BROWSER:[{type:0,value:"Si è verificato un errore"}],ERRORS_BROWSER_MESSAGE:[{type:0,value:"Il browser ha impiegato troppo tempo per eseguire il rendering dell’immagine. Prova ad applicare un minor numero di operazioni."}],ERRORS_BROWSER_MULTIPLE_MESSAGE:[{type:0,value:"Il browser ha impiegato troppo tempo per eseguire il rendering dell’immagine. Prova ad applicare un minor numero di operazioni."}],ERRORS_STICKERS_LOAD:[{type:0,value:"Impossibile caricare adesivi"}],RETRY_DIALOG_MESSAGE:[{type:0,value:"L’operazione sta impiegando più tempo del previsto. Vuoi riprovare a salvare le modifiche?"}],SAVE_PHOTO:[{type:0,value:"Salva questa foto"}],IMAGE_TOO_LARGE:[{type:0,value:"Spiacenti, questa immagine è troppo grande per essere modificata. Riprova con un immagine con dimensioni inferiori a 50 megapixel."}],NO_ORIGINAL_PHOTO:[{type:0,value:"Impossibile ottenere la foto originale. Riprova."}],CROSS_PLATFORM_EDIT_WARNING:[{type:0,value:"La foto è stata modificata l’ultima volta da un dispositivo cellulare. Se scegli di sostituire la foto, non potrai annullare le modifiche apportate finora dal dispositivo cellulare."}],SAVE:[{type:0,value:"Salva una nuova copia"}],EDIT:[{type:0,value:"Modifica editor foto Flickr"}],NO_VIDEOS_IN_EDITOR:[{type:0,value:"I video non possono essere modificati con l’editor di foto di Flickr"}],ERROR:[{type:0,value:"Si è verificato un errore con l’editor di foto. Riprova."}],FLICKR_PHOTO_EDITOR:[{type:0,value:"Editor di foto di Flickr"}],CATEGORY_SHAPES:[{type:0,value:"Forme"}],CATEGORY_FOOD:[{type:0,value:"Cibo e bevande"}],CATEGORY_FUN:[{type:0,value:"Divertenti"}],CATEGORY_WEAR:[{type:0,value:"Abiti e accessori"}],STICKER_SQUARE_OUTLINE:[{type:0,value:"Riquadro quadrato"}],STICKER_CIRCLE_OUTLINE:[{type:0,value:"Riquadro rotondo"}],STICKER_ARROW:[{type:0,value:"Freccia"}],STICKER_TRIANGLE_OUTLINE:[{type:0,value:"Riquadro triangolare"}],STICKER_LIGHTNING:[{type:0,value:"Fulmine"}],STICKER_X:[{type:0,value:"X"}],STICKER_HEART:[{type:0,value:"Cuore"}],STICKER_STAR:[{type:0,value:"Stella"}],STICKER_BACON:[{type:0,value:"Pancetta"}],STICKER_BANANA:[{type:0,value:"Banana"}],STICKER_BUBBLE_TEA:[{type:0,value:"Bubble tea"}],STICKER_CAN:[{type:0,value:"Lattina"}],STICKER_CHERRY:[{type:0,value:"Ciliegia"}],STICKER_COFFEE:[{type:0,value:"Caffè"}],STICKER_HOT_SAUCE:[{type:0,value:"Salsa piccante"}],STICKER_ICE:[{type:0,value:"Ghiaccio"}],STICKER_LOLLIPOP:[{type:0,value:"Lecca lecca"}],STICKER_MUSHROOM:[{type:0,value:"Fungo"}],STICKER_POPCORN:[{type:0,value:"Popcorn"}],STICKER_ROOTBEER:[{type:0,value:"Bevanda frizzante"}],STICKER_SPORK:[{type:0,value:"Cucchiaio-forchetta"}],STICKER_BUBBLE_BLUE:[{type:0,value:"Bolla blu"}],STICKER_BUBBLE_PINK:[{type:0,value:"Bolla rosa"}],STICKER_DIAMOND:[{type:0,value:"Diamante"}],STICKER_DICE:[{type:0,value:"Dado"}],STICKER_FIRE:[{type:0,value:"Fuoco"}],STICKER_FLAMINGO:[{type:0,value:"Fenicottero"}],STICKER_FLOWER_ROSE:[{type:0,value:"Rosa"}],STICKER_FLOWER_TULIP:[{type:0,value:"Tulipano"}],STICKER_GIFT_BOX:[{type:0,value:"Confezione regalo"}],STICKER_MONEYBAG:[{type:0,value:"Sacca porta soldi"}],STICKER_RAINBOW:[{type:0,value:"Arcobaleno"}],STICKER_SKULL:[{type:0,value:"Teschio"}],STICKER_TICKET:[{type:0,value:"Biglietto"}],STICKER_BOBBLES:[{type:0,value:"Cerchietto con antenne"}],STICKER_CROWN:[{type:0,value:"Corona"}],STICKER_GLASSES_RAYBAND:[{type:0,value:"Occhiali da sole firmati"}],STICKER_GLASSES_SPARKLE:[{type:0,value:"Occhiali da sole scintillanti"}],STICKER_GOOGLY_EYE:[{type:0,value:"Occhi finti"}],STICKER_LIPS:[{type:0,value:"Labbra"}],STICKER_MUSTACHE:[{type:0,value:"Baffi"}],STICKER_PARTY_HAT_STARS:[{type:0,value:"Cappellino da festa con stelle"}],STICKER_PARTY_HAT_STRIPES:[{type:0,value:"Cappellino da festa con strisce"}],STICKER_TONGUE:[{type:0,value:"Linguaccia"}],STICKER_VIKING:[{type:0,value:"Elmo vichingo"}],SELECTIVE_BLUR_RADIUS:[{type:0,value:"Raggio sfocatura"}],SELECTIVE_BLUR_THICKNESS:[{type:0,value:"Spessore"}],FRAME_NONE:[{type:0,value:"Nessuna cornice"}],FRAME_SCALE:[{type:0,value:"Scala"}],V4_CHANGES_YES:[{type:0,value:"Sì"}],V4_CHANGES_NO:[{type:0,value:"No"}],V4_KEEP_CHANGES:[{type:0,value:"Mantieni le modifiche"}],V4_DISCARD:[{type:0,value:"Elimina le modifiche"}],V4_IMAGE_RESIZED:[{type:0,value:"Immagine ridimensionata"}],V4_ERROR_FONT:[{type:0,value:"Errore durante il caricamento dei tipi di carattere"}],V4_DISCARD_CHANGES:[{type:0,value:"Eliminare le modifiche?"}],V4_CHANGES_LOST:[{type:0,value:"Eventuali modifiche non salvate andranno perse. Continuare?"}],V4_ERROR_LOADING_FONTS:[{type:0,value:"Non è stato possibile caricare i seguenti tipi di carattere: $fonts@."}],V4_TRANSFORM_TOOL:[{type:0,value:"Trasforma"}],V4_LOCK_RESOLUTION:[{type:0,value:"Blocca la risoluzione"}],V4_RESET:[{type:0,value:"Ripristina impostazioni predefinite"}],V4_WIDTH_UNIT:[{type:0,value:"l"}],V4_HEIGHT_UNIT:[{type:0,value:"h"}],V4_BASIC_ADJUSTMENTS:[{type:0,value:"Impostazioni di base"}],V4_REFINEMENTS:[{type:0,value:"Perfezionamenti"}],V4_WHITES:[{type:0,value:"Bianchi"}],V4_BLACKS:[{type:0,value:"Neri"}],V4_TEMPERATURE:[{type:0,value:"Temperatura"}],V4_SHARPNESS:[{type:0,value:"Nitidezza"}],V4_MIRRORED_BLUR:[{type:0,value:"Specchio"}],V4_GAUSSIAN_BLUR:[{type:0,value:"Gaussiano"}],V4_TEXT_SPACING:[{type:0,value:"Spaziatura"}],V4_TEXT_LINE:[{type:0,value:"Linea"}],V4_TEXT_EDIT:[{type:0,value:"Fai doppio clic per modificare"}],V4_TEXT_DESIGN:[{type:0,value:"Design del testo"}],V4_TEXT:[{type:0,value:"Testo"}],V4_TEXT_MASK:[{type:0,value:"Testo come maschera"}],V4_TEXT_NEW:[{type:0,value:"Nuovo design del testo"}],V4_OPACITY:[{type:0,value:"Opacità"}],V4_ERROR_STICKER:[{type:0,value:"Impossibile caricare l’adesivo."}],V4_REPLACE:[{type:0,value:"Sostituisci"}],V4_STICKER_NEW:[{type:0,value:"Nuovo adesivo"}],V4_FILL:[{type:0,value:"Riempi"}],V4_BRUSH_WIDTH:[{type:0,value:"Larghezza"}],V4_BRUSH_HARDNESS:[{type:0,value:"Durezza"}],V4_BRUSH_SETTINGS:[{type:0,value:"Impostazioni del pennello"}],V4_NOTHING_SELECTED:[{type:0,value:"Nessuna selezione"}],V4_ART_FILTERS:[{type:0,value:"Filtri artistici"}]})}),"@VERSION@",{requires:["intl"]});